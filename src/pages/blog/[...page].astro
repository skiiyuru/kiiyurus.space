---
export const prerender = true

// tools
import type { GetStaticPaths } from "astro"
import { getCollection } from "astro:content"

// layouts
import BaseLayout from "@/layouts/BaseLayout.astro"

// components
import PostCard from "@/components/ui/PostCard.astro"
import Container from "@/layouts/Container.astro"
import Heading from "@/components/ui/Heading.astro"
import ButtonLink from "@/components/ui/ButtonLink.astro"

// data
export const getStaticPaths = (async ({ paginate }) => {
  const allPosts = await getCollection("posts", ({ data }) => !data.isDraft)
  return paginate(
    allPosts.sort(
      (a, b) =>
        new Date(b.data.pubDate).getUTCDate() -
        new Date(a.data.pubDate).getUTCDate()
    ),
    { pageSize: 3 }
  )
}) satisfies GetStaticPaths

const { page } = Astro.props
---

<BaseLayout title=`My Writings  | Page ${page.currentPage}`>
  <section class="py-10 grid gap-10 bg-zinc-900 px-4">
    <div class="grid gap-4 text-center">
      <Heading tagName="h2">My Writings</Heading>
      <p>
        I like to write about productivity, web development, design and working
        with clients. Get a sense of what it's like to work with me and
        understand my process.
      </p>
    </div>
    <div class="grid md:grid-cols-2 lg:grid-cols-3">
      {page.data.map((post) => <PostCard post={post} />)}
    </div>
    <div class="flex gap-4 justify-center items-center">
      {
        page.url.prev && (
          <ButtonLink href={page.url.prev} variant="badge">
            {"<"}
          </ButtonLink>
        )
      }
      <p class="font-medium">
        Page {page.currentPage}
      </p>
      {
        page.url.next && (
          <ButtonLink href={page.url.next} variant="badge">
            {">"}
          </ButtonLink>
        )
      }
    </div>
  </section>
</BaseLayout>
